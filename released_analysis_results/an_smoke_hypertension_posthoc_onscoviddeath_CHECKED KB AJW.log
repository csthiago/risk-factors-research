----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\opensafely-risk-factors-research-full\analysis\output/an_smoke_hypertension_posthoc_onscoviddeath.log
  log type:  text
 opened on:   7 Jul 2020, 00:35:44

. 
. 
. ***************************************
. *Smoking adjusted for demographics only
. 
. use "cr_create_analysis_dataset_STSET_`outcome'.dta", clear
(Analysis dataset for the poor outcomes in Covid project)

. 
. cap stcox age1 age2 age3 i.male i.ethnicity i.imd i.smoke_nomiss, strata(stp)

. if _rc==0{
. estimates 

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   12,717,951                  Number of obs    =  12,717,951
No. of failures =        8,149
Time at risk    =   1206440035
                                                LR chi2(14)      =    25867.82
Log likelihood  =   -94561.449                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.160809   .0289155     5.99   0.000     1.105496    1.218888
                   age2 |   .9276149   .0500848    -1.39   0.164     .8344661    1.031162
                   age3 |   1.200875   .1497686     1.47   0.142     .9404574    1.533403
                 1.male |   1.638653   .0376374    21.50   0.000     1.566521    1.714107
                        |
              ethnicity |
                 Mixed  |    1.52994   .1967254     3.31   0.001     1.189115    1.968453
Asian or Asian British  |   1.640039   .0757269    10.71   0.000     1.498135    1.795384
                 Black  |   1.685128   .1136715     7.74   0.000     1.476436    1.923319
                 Other  |   1.336391   .1305137     2.97   0.003     1.103581    1.618315
                        |
                    imd |
                     2  |   1.197432   .0459143     4.70   0.000      1.11074     1.29089
                     3  |   1.347054   .0513675     7.81   0.000     1.250046     1.45159
                     4  |   1.704726   .0636422    14.29   0.000     1.584444    1.834139
       5 most deprived  |   2.065667   .0785097    19.09   0.000     1.917382    2.225419
                        |
           smoke_nomiss |
                Former  |   1.427339   .0356605    14.24   0.000      1.35913    1.498972
               Current  |   1.073073   .0517986     1.46   0.144      .976204    1.179554
-----------------------------------------------------------------------------------------
                                                             Stratified by stp
. estimates save ./output/models/an_smoke_hypertension_posthoc_`outcome'_smokeadjdemog, replace   
file ./output/models/an_smoke_hypertension_posthoc_onscoviddeath_smokeadjdemog.ster saved
. }

. 
. 
. 
. **********************************
. *Hypertension adjusted for diabetes and obesity
. cap stcox age1 age2 age3 i.male htdiag_or_highbp i.obese4cat i.diabcat, strata(stp)

. if _rc==0{
. estimates 

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   17,277,935                  Number of obs    =  17,277,935
No. of failures =       10,926
Time at risk    =   1638907207
                                                LR chi2(11)      =    34936.97
Log likelihood  =   -129610.59                  Prob > chi2      =      0.0000

---------------------------------------------------------------------------------------------
                         _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                       age1 |   1.162858   .0248265     7.07   0.000     1.115203    1.212549
                       age2 |   .9050482   .0420588    -2.15   0.032     .8262572    .9913527
                       age3 |   1.295419   .1393719     2.41   0.016     1.049134     1.59952
                     1.male |   1.754962   .0344605    28.64   0.000     1.688704     1.82382
           htdiag_or_highbp |   .9669555   .0221486    -1.47   0.142      .924505    1.011355
                            |
                  obese4cat |
         Obese I (30-34.9)  |   1.119467   .0298563     4.23   0.000     1.062453    1.179541
        Obese II (35-39.9)  |    1.55484   .0605444    11.33   0.000     1.440591    1.678151
           Obese III (40+)  |   2.183599   .1177609    14.48   0.000     1.964572    2.427046
                            |
                    diabcat |
       Controlled diabetes  |   1.514565   .0373468    16.84   0.000     1.443107    1.589561
     Uncontrolled diabetes  |   2.423218   .0764977    28.04   0.000     2.277829    2.577886
Diabetes, no hba1c measure  |    2.18661    .108051    15.83   0.000     1.984766    2.408981
---------------------------------------------------------------------------------------------
                                                             Stratified by stp
. estimates save ./output/models/an_smoke_hypertension_posthoc_`outcome'_htadjdiabobes, replace   
(note: file ./output/models/an_smoke_hypertension_posthoc_onscoviddeath_htadjdiabobes.ster not found)
file ./output/models/an_smoke_hypertension_posthoc_onscoviddeath_htadjdiabobes.ster saved
. }

. 
. **********************************
. *Hypertension with age interaction
. 
. stcox ib3.agegroup      ///
>                         i.male                                                  ///
>                         i.obese4cat                                             ///
>                         i.smoke_nomiss                                  ///
>                         `ethnicity'                                             ///
>                         i.imd                                                   ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthmacat                                             ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabcat                                               ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke_dementia                               ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat   ///
>                         i.organ_transplant                              ///
>                         i.spleen                                                ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immunosuppression                       ///
>                         ib3.agegroup i.htdiag_or_highbp ///
>                         1.agegroup#1.htdiag_or_highbp 2.agegroup#1.htdiag_or_highbp 4.agegroup#1.htdiag_or_highbp  5.agegroup#1.
> htdiag_or_highbp 6.agegroup#1.htdiag_or_highbp ///
>                         , strata(stp)

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -147079.08
Iteration 1:   log likelihood = -134126.85
Iteration 2:   log likelihood = -128970.47
Iteration 3:   log likelihood = -128578.22
Iteration 4:   log likelihood = -128536.04
Iteration 5:   log likelihood = -128530.62
Iteration 6:   log likelihood = -128530.41
Iteration 7:   log likelihood = -128530.41
Refining estimates:
Iteration 0:   log likelihood = -128530.41

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   17,277,935                  Number of obs    =  17,277,935
No. of failures =       10,926
Time at risk    =   1638907207
                                                LR chi2(43)      =    37097.32
Log likelihood  =   -128530.41                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------------
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                     agegroup |
                      18-<40  |   .0727472   .0126291   -15.10   0.000     .0517662     .102232
                      40-<50  |   .3059811   .0426127    -8.50   0.000     .2328904    .4020108
                      60-<70  |   2.916956   .2591629    12.05   0.000     2.450773    3.471815
                      70-<80  |   9.139086   .7399632    27.33   0.000     7.798008     10.7108
                         80+  |   37.29885     2.8905    46.70   0.000     32.04284    43.41701
                              |
                       1.male |   1.451314   .0291617    18.54   0.000     1.395269     1.50961
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .9477881   .0251877    -2.02   0.044     .8996847    .9984635
          Obese II (35-39.9)  |   1.212113   .0471496     4.95   0.000     1.123137    1.308139
             Obese III (40+)  |   1.575488   .0850716     8.42   0.000      1.41727    1.751368
                              |
                 smoke_nomiss |
                      Former  |   1.189137   .0257467     8.00   0.000      1.13973    1.240685
                     Current  |   .8148258     .03457    -4.83   0.000     .7498105    .8854785
                              |
                          imd |
                           2  |   1.121989   .0359511     3.59   0.000     1.053694    1.194712
                           3  |   1.228628   .0393233     6.43   0.000     1.153923    1.308169
                           4  |   1.516753   .0478625    13.20   0.000     1.425786    1.613523
             5 most deprived  |    1.78983   .0578514    18.01   0.000      1.67996    1.906885
                              |
1.chronic_respiratory_disease |    1.59751   .0402356    18.60   0.000     1.520565    1.678349
                              |
                    asthmacat |
                 Yes, no OCS  |   .9640331   .0297027    -1.19   0.234     .9075397    1.024043
                Yes with OCS  |   1.086356   .0614774     1.46   0.143     .9723044    1.213786
                              |
    1.chronic_cardiac_disease |   1.221801   .0264578     9.25   0.000     1.171029    1.274773
                              |
                      diabcat |
         Controlled diabetes  |   1.262893   .0314826     9.36   0.000     1.202671     1.32613
       Uncontrolled diabetes  |   1.800465   .0577437    18.34   0.000     1.690773    1.917273
  Diabetes, no hba1c measure  |    1.96257   .0972096    13.61   0.000     1.780999    2.162653
                              |
            cancer_exhaem_cat |
                   Last year  |   1.681543   .1149739     7.60   0.000     1.470645    1.922684
               2-5 years ago  |   1.131106   .0548798     2.54   0.011       1.0285    1.243949
                    5+ years  |   .9802644    .031267    -0.62   0.532     .9208586    1.043503
                              |
              cancer_haem_cat |
                   Last year  |   2.669663   .4085389     6.42   0.000     1.977866    3.603428
               2-5 years ago  |   2.317566   .2131125     9.14   0.000     1.935351    2.775266
                    5+ years  |   1.570571   .1207691     5.87   0.000     1.350841    1.826042
                              |
      1.chronic_liver_disease |   1.654868   .1256395     6.63   0.000     1.426065    1.920382
            1.stroke_dementia |   2.319444   .0561264    34.77   0.000     2.212006      2.4321
                1.other_neuro |    2.47239   .1004657    22.28   0.000     2.283118    2.677353
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.557306   .0349601    19.73   0.000     1.490271    1.627357
           Stage 4/5 egfr<30  |   3.239696   .1253606    30.38   0.000      3.00308    3.494956
                              |
           1.organ_transplant |   2.789821   .3437888     8.33   0.000     2.191205    3.551973
                     1.spleen |   1.290856    .204883     1.61   0.108     .9457496    1.761892
           1.ra_sle_psoriasis |   1.152257   .0390461     4.18   0.000     1.078214    1.231385
    1.other_immunosuppression |   2.030832   .2831707     5.08   0.000     1.545205    2.669082
           1.htdiag_or_highbp |   2.068369   .1874925     8.02   0.000     1.731684    2.470514
                              |
    agegroup#htdiag_or_highbp |
                    18-<40#1  |   1.499671   .4850441     1.25   0.210     .7955888    2.826853
                    40-<50#1  |   1.321809   .2533706     1.46   0.146     .9078341    1.924558
                    60-<70#1  |   .6403509   .0710167    -4.02   0.000     .5152493     .795827
                    70-<80#1  |   .4535902   .0455391    -7.87   0.000      .372568    .5522323
                       80+#1  |   .3552475   .0338571   -10.86   0.000      .294718    .4282085
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp

.                         
. estimates save ./output/models/an_smoke_hypertension_posthoc_`outcome'_ht_byage, replace        
file ./output/models/an_smoke_hypertension_posthoc_onscoviddeath_ht_byage.ster saved

. 
. lincom 1.htdiag_or_highbp + 1.agegroup#1.htdiag_or_highbp, eform

 ( 1)  1.htdiag_or_highbp + 1.agegroup#1.htdiag_or_highbp = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   3.101873   .9634499     3.64   0.000     1.687479    5.701767
------------------------------------------------------------------------------

. lincom 1.htdiag_or_highbp + 2.agegroup#1.htdiag_or_highbp, eform

 ( 1)  1.htdiag_or_highbp + 2.agegroup#1.htdiag_or_highbp = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   2.733989   .4625103     5.95   0.000      1.96245     3.80886
------------------------------------------------------------------------------

. lincom 1.htdiag_or_highbp , eform

 ( 1)  1.htdiag_or_highbp = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   2.068369   .1874925     8.02   0.000     1.731684    2.470514
------------------------------------------------------------------------------

. lincom 1.htdiag_or_highbp + 4.agegroup#1.htdiag_or_highbp, eform

 ( 1)  1.htdiag_or_highbp + 4.agegroup#1.htdiag_or_highbp = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.324482   .0855389     4.35   0.000     1.167006    1.503208
------------------------------------------------------------------------------

. lincom 1.htdiag_or_highbp + 5.agegroup#1.htdiag_or_highbp, eform

 ( 1)  1.htdiag_or_highbp + 5.agegroup#1.htdiag_or_highbp = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .938192   .0411975    -1.45   0.146     .8608234    1.022514
------------------------------------------------------------------------------

. lincom 1.htdiag_or_highbp + 6.agegroup#1.htdiag_or_highbp, eform

 ( 1)  1.htdiag_or_highbp + 6.agegroup#1.htdiag_or_highbp = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7347829   .0220403   -10.27   0.000     .6928299    .7792762
------------------------------------------------------------------------------

. 
. log close
      name:  <unnamed>
       log:  E:\analyses\opensafely-risk-factors-research-full\analysis\output/an_smoke_hypertension_posthoc_onscoviddeath.log
  log type:  text
 closed on:   7 Jul 2020, 02:01:12
----------------------------------------------------------------------------------------------------------------------------------
